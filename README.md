# Excel 解析与图表生成工具

这是一个基于 Vue.js 的 Excel 数据解析和可视化工具，允许用户上传 Excel 文件，自动或手动映射数据列，并生成基于月份和区域的交互式图表。

## 项目结构

项目采用视图组件和功能组件分离的架构，并使用组合式 API 进一步优化代码结构：

```
src/
├── assets/           # 静态资源文件
├── views/            # 视图组件目录
│   ├── FileUploadView.vue  # 文件上传视图
│   └── DataVisualView.vue  # 数据可视化视图
├── components/       # UI组件目录
│   ├── FileUploader.vue   # 文件上传组件
│   ├── SheetSelector.vue  # 工作表选择组件
│   ├── ColumnMapper.vue   # 列映射组件
│   ├── FilterPanel.vue    # 筛选侧边栏组件
│   ├── ChartDisplay.vue   # 图表展示组件
│   └── PieChart.vue       # 饼图组件 (基于 vue-chartjs)
├── composables/      # 组合式函数目录
│   ├── useExcelParser.js    # Excel 解析相关功能
│   ├── useDataFilter.js     # 数据筛选相关功能
│   ├── useColumnMapping.js  # 列映射管理功能
│   └── useViewState.js      # 视图状态管理
├── App.vue           # 主应用容器
└── main.js           # 应用入口
```

## 组件职责

### 视图组件

**FileUploadView.vue**
- 提供文件上传界面
- 管理上传相关的用户交互
- 提供文件上传指引和说明

**DataVisualView.vue**
- 提供数据可视化界面
- 协调数据筛选和图表显示
- 管理工作表切换和列映射

### UI 组件

**FileUploader.vue**
- 允许用户选择和上传 Excel 文件
- 验证文件类型
- 显示上传状态和错误信息

**SheetSelector.vue**
- 显示和切换 Excel 工作表

**ColumnMapper.vue**
- 允许用户手动选择和映射月份和区域列
- 支持自动检测和手动设置

**FilterPanel.vue**
- 提供月份筛选功能
- 显示数据统计和摘要信息

**ChartDisplay.vue**
- 展示区域会议数量的饼图
- 显示数据统计摘要
- 支持不同筛选条件下的数据可视化

**PieChart.vue**
- 封装 Chart.js 的饼图组件
- 处理图表的渲染和更新

### 组合式函数

**useExcelParser.js**
- 处理 Excel 文件的解析
- 处理工作表数据和表头识别
- 自动检测月份和区域列
- 管理工作表切换逻辑

**useDataFilter.js**
- 基于月份筛选数据
- 计算筛选后的数据统计
- 生成区域会议数量统计

**useColumnMapping.js**
- 管理列映射状态
- 处理手动和自动列选择
- 维护列映射的一致性

**useViewState.js**
- 管理应用的视图状态
- 提供不同视图间的切换功能
- 实现文件上传和数据查看两个主要视图

## 应用特性

1. **模块化视图结构**：
   - **文件上传视图**：专注于文件选择和上传流程
   - **数据可视化视图**：专注于数据展示和交互

2. **文件处理**：
   - 支持 Excel 文件（.xlsx, .xls）上传和解析
   - 支持多工作表文件，可以在工作表间切换

3. **数据可视化**：
   - 自动检测月份和区域列
   - 支持按月份筛选数据
   - 生成交互式饼图，展示区域会议数量分布
   - 提供详细的数据统计和摘要信息

4. **用户友好的界面**：
   - 清晰的视图分离，专注当前任务
   - 直观的布局，将筛选区域和图表合理展示
   - 响应式设计，适配各种屏幕尺寸

## 重构历程

本项目通过四个阶段的重构优化了代码结构：

### 阶段一：组件化拆分

将原始的单一 App.vue 文件（超过 1100 行代码）拆分为多个独立 UI 组件，每个组件专注于特定功能。

### 阶段二：逻辑抽离

将业务逻辑从 UI 组件中抽离出来，使用组合式函数（Composables）进行管理。这进一步降低了耦合度，提高了代码的可复用性和可测试性。

### 阶段三：用户体验优化

添加视图状态管理，优化用户界面流程，实现更直观的交互体验。专注于数据可视化，移除了复杂的表格视图，提供更加清晰和集中的用户体验。

### 阶段四：视图分离

将应用划分为明确的视图组件，进一步将不同功能页面解耦，提高代码可维护性，为未来功能扩展做好准备。

## 使用指南

1. **文件上传**：
   - 在文件上传视图中，点击"选择 Excel 文件"按钮上传文件
   - 系统自动解析文件后，切换到数据可视化视图

2. **数据可视化**：
   - 如果文件有多个工作表，可以在顶部切换工作表
   - 使用左侧筛选面板按月份筛选数据
   - 查看饼图展示的区域会议数量分布
   - 随时可以点击"选择新文件"返回上传界面

## 技术栈

- Vue 3 (组合式 API)
- SheetJS (xlsx) - Excel 文件解析
- Chart.js - 数据可视化图表
- Vue-ChartJS - Vue 图表组件
